const sizeGroup=document.getElementById("sizeGroup"),sizeOptionsDiv=document.getElementById("sizeOptions"),dimensionGroup=document.getElementById("dimensionGroup"),qtyGroup=document.getElementById("qtyGroup"),colorGroup=document.getElementById("colorGroup"),colorInput=document.getElementById("color"),widthEl=document.getElementById("width"),heightEl=document.getElementById("height"),qtyEl=document.getElementById("qty"),priceEl=document.getElementById("price");let servicesData=[];async function loadServices(){const e=await fetch("services.json"),t=await e.json();servicesData=t.services,renderServiceButtons()}function renderServiceButtons(){document.getElementById("serviceGroup").innerHTML='<p class="font-semibold mb-2">Print Services</p>\n                         <div class="flex gap-4 overflow-x-auto overflow-y-hidden py-2 px-1 scroll-smooth no-scrollbar" id="serviceButtons"></div>';const e=document.getElementById("serviceButtons");servicesData.forEach(t=>{const n=document.createElement("label");n.className="cursor-pointer",n.innerHTML=`\n      <input type="radio" name="service" value="${t.name}" class="peer hidden" />\n      <div class="flex-shrink-0 w-36 h-36 flex flex-col items-center justify-center \n  p-4 border rounded-xl bg-white shadow-sm\n  hover:bg-blue-50 peer-checked:border-blue-500 peer-checked:bg-blue-100 \n  transition relative text-center">\n        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-700 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${t.icon}" />\n        </svg>\n        <span class="text-gray-700 font-medium">${t.name}</span>\n      </div>\n    `,e.appendChild(n)}),document.querySelectorAll('input[name="service"]').forEach(e=>e.addEventListener("change",handleServiceChange))}function handleServiceChange(){const e=document.querySelector('input[name="service"]:checked')?.value,t=servicesData.find(t=>t.name===e);sizeGroup.classList.add("hidden"),dimensionGroup.classList.add("hidden"),qtyGroup.classList.add("hidden"),colorGroup.classList.add("hidden"),sizeOptionsDiv.innerHTML="",widthEl.value="",heightEl.value="",qtyEl.value=1,colorInput.value="",t&&(qtyGroup.classList.remove("hidden"),colorGroup.classList.remove("hidden"),"Tarpaulin"===t.name?dimensionGroup.classList.remove("hidden"):t.sizes&&(sizeGroup.classList.remove("hidden"),t.sizes.forEach(e=>{const t=document.createElement("label");t.className="inline-flex items-center mr-4 mb-2 cursor-pointer",t.innerHTML=`\n        <input type="radio" name="size" value="${e}" class="hidden peer" />\n        <div class="px-4 py-2 border rounded-lg peer-checked:bg-blue-100 peer-checked:border-blue-500 transition">${e}</div>\n      `,sizeOptionsDiv.appendChild(t)}),document.querySelectorAll('input[name="size"]').forEach(e=>e.addEventListener("change",calculatePrice))),calculatePrice())}function getSelectedSize(){const e=document.querySelector('input[name="size"]:checked');return e?e.value:""}const colorPalette=[{name:"Red",bg:"bg-red-600"},{name:"Blue",bg:"bg-blue-600"},{name:"Green",bg:"bg-green-600"},{name:"Yellow",bg:"bg-yellow-400"},{name:"Black",bg:"bg-black"},{name:"White",bg:"bg-white border-gray-300"}],colorOptionsDiv=document.getElementById("colorOptions");function calculatePrice(){const e=document.querySelector('input[name="service"]:checked')?.value;if(!e)return priceEl.innerText="0",0;const t=servicesData.find(t=>t.name===e);let n=0;if("Tarpaulin"===t.name){const e=parseFloat(widthEl.value||0),i=parseFloat(heightEl.value||0),r=parseInt(qtyEl.value||1);n=e*i*(t.tarpaulinRate||35)*r}else if(t.prices){const e=getSelectedSize(),i=parseInt(qtyEl.value||1);n=(t.prices[e]||0)*i}return priceEl.innerText=n.toFixed(2),n}function fileToBase64(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=n,i.readAsDataURL(e)})}function sendEmail(e){const t={order_id:100001,to_email:e.email,from_name:e.name,service:e.service,size:e.size||"-",dimensions:`${e.width||"-"} x ${e.height||"-"} ft`,quantity:e.qty,color:e.color||"-",price:`â‚±${e.price}.00`,description:e.desc,image_url:"https://static.vecteezy.com/system/resources/thumbnails/074/482/764/small/3d-product-feedback-icon-on-transparent-background-png.png"};emailjs.send("service_b9niqqs","template_3lguulw",t).then(function(e){alert("Order sent via email successfully!")},function(e){alert("Failed to send email. "+JSON.stringify(e))})}colorPalette.forEach(e=>{const t=document.createElement("button");t.type="button",t.setAttribute("data-color",e.name),t.className=`w-8 h-8 rounded-full border-2 ${e.bg} hover:ring-2 hover:ring-blue-500`,colorOptionsDiv.appendChild(t)}),document.querySelectorAll("#colorOptions button").forEach(e=>{e.addEventListener("click",()=>{document.querySelectorAll("#colorOptions button").forEach(e=>e.classList.remove("ring-2","ring-blue-500")),e.classList.add("ring-2","ring-blue-500"),colorInput.value=e.getAttribute("data-color"),calculatePrice()})}),[widthEl,heightEl,qtyEl].forEach(e=>e.addEventListener("input",calculatePrice)),document.getElementById("submitBtn").addEventListener("click",async()=>{const e=document.getElementById("name").value,t=document.getElementById("email").value,n=document.getElementById("phone").value,i=document.getElementById("desc").value,r=document.querySelector('input[name="service"]:checked')?.value,o=getSelectedSize(),l=colorInput.value;if(!e||!r||!i)return void alert("Please fill required fields");sendEmail({name:e,email:t,phone:n,service:r,size:o,width:widthEl.value||"",height:heightEl.value||"",qty:qtyEl.value||1,color:l,desc:i,price:calculatePrice()}),location.href="thankyou.html"}),window.addEventListener("DOMContentLoaded",loadServices);